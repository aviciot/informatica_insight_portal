


SELECT /*+ leading(SF_BILLING_CONTRACT,SF_TERMINAL,SF_MPS,SF_GATEWAY_TERMINAL,SF_GATEWAY_MID,SF_OPPORTUNITY) */  SF_BILLING_CONTRACT.NAME, SF_GATEWAY_MID.GW_MID, SF_TERMINAL.TERMINAL_NUMBER, SF_OPPORTUNITY_PRODUCTS.ID, SF_OPPORTUNITY_PRODUCTS.PRODUCT, SF_OPPORTUNITY_PRODUCTS.PRODUCT_MAIN_STATUS, SF_OPPORTUNITY_PRODUCTS.PRODUCT_NAME, SF_OPPORTUNITY_PRODUCTS.EFFECTIVE_DATE, SF_OPPORTUNITY_PRODUCTS.DISCONNECTION_DATE, SF_OPPORTUNITY_PRODUCTS.BILLABLE, STG_SOURCE_LAYOUT.TYPE_OF_FEE, STG_SOURCE_LAYOUT.SOURCE_LAYOUT_ID, SF_MPS.MPS_ID, SF_MPS.MAIN_SOURCE_MPS, SF_MPS.COMMENTS, SF_MPS.SOURCE_MPS_CURRENCY, SF_FEE_DETAILS.FEE_DETAIL_ID, SF_FEE_DETAILS.FEE_NAME FROM SF_GATEWAY_MID, SF_TERMINAL, SF_GATEWAY_TERMINAL, SF_BILLING_CONTRACT, SF_OPPORTUNITY, SF_FEE_DETAILS, SF_OPPORTUNITY_PRODUCTS, SF_MPS, STG_SOURCE_LAYOUT WHERE SF_OPPORTUNITY.OPPORTUNITY_ID_FULL=SF_GATEWAY_MID.MERCHANT_ID AND SF_OPPORTUNITY.ETL_RUN_DATE=SF_GATEWAY_MID.ETL_RUN_DATE
AND
SF_GATEWAY_MID.GATEWAY_MID_ID=SF_GATEWAY_TERMINAL.GATEWAY_MID__C AND SF_GATEWAY_MID.ETL_RUN_DATE=SF_GATEWAY_TERMINAL.ETL_RUN_DATE
AND
SF_GATEWAY_TERMINAL.TERMINAL__C=SF_TERMINAL.TERMINAL_ID AND SF_GATEWAY_TERMINAL.ETL_RUN_DATE=SF_TERMINAL.ETL_RUN_DATE
AND
SF_TERMINAL.BILLING_CONTRACT=SF_BILLING_CONTRACT.ID AND SF_TERMINAL.ETL_RUN_DATE=SF_BILLING_CONTRACT.ETL_RUN_DATE
AND
SF_OPPORTUNITY.OPPORTUNITY_ID_FULL=SF_OPPORTUNITY_PRODUCTS.OPPORTUNITY AND SF_OPPORTUNITY_PRODUCTS.ETL_RUN_DATE=SF_OPPORTUNITY.ETL_RUN_DATE
AND
STG_SOURCE_LAYOUT.PRODUCT_ID=SF_OPPORTUNITY_PRODUCTS.PRODUCT
AND
SF_TERMINAL.SOURCE_MPS=SF_MPS.MPS_ID AND SF_MPS.ETL_RUN_DATE=SF_TERMINAL.ETL_RUN_DATE
AND
SF_FEE_DETAILS.MERCHANT_PRICING_AND_SETUP_ID=SF_MPS.MPS_ID AND SF_MPS.ETL_RUN_DATE=SF_FEE_DETAILS.ETL_RUN_DATE AND STG_SOURCE_LAYOUT.ATTRIBUTE_NAME=SF_FEE_DETAILS.FEE_NAME AND SF_BILLING_CONTRACT.ETL_RUN_DATE=TO_DATE('07/09/2025','MM/DD/YYYY')
AND
SF_OPPORTUNITY.TYPE_OF_SALE NOT IN  ('PSP','Payment facilitator')
AND
SF_BILLING_CONTRACT.ACTIVESOURCEBILLINGCONTRACT = '1' AND SF_BILLING_CONTRACT.TYPE='Effective'
--AND
--SF_OPPORTUNITY_PRODUCTS.PRODUCT_MAIN_STATUS='Processing' AND SF_OPPORTUNITY_PRODUCTS.BILLABLE='1'
AND
SF_TERMINAL.TERMINAL_NUMBER IS NOT NULL
--ONLY TO MAKE IT RUNABLE ON DEV
AND
SF_MPS.ACTIVE_MPS = '1'
AND
SF_FEE_DETAILS.ACTIVE='1'
AND SF_GATEWAY_MID.ACTIVE = '1'
and
 SF_OPPORTUNITY.CRM_TEST = '0'


